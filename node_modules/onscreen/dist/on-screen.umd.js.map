{"version":3,"file":null,"sources":["../lib/helpers/observe-dom.js","../lib/methods/attach.js","../lib/helpers/in-viewport.js","../lib/helpers/in-container.js","../lib/helpers/scroll-handler.js","../lib/methods/debounced-scroll.js","../lib/methods/destroy.js","../lib/methods/off.js","../lib/methods/on.js","../lib/index.js"],"sourcesContent":["/**\n * Observes DOM mutations and runs a callback function when\n * detecting one.\n *\n * @param {node} obj The DOM node you want to observe\n * @param {function} callback The callback function you want to call\n * @return {MutationObserver} obs The mutation observer instance used to track DOM mutations\n */\nfunction observeDOM(obj, callback) {\n    const MutationObserver = window.MutationObserver || window.WebKitMutationObserver;\n\n    /* istanbul ignore else */\n    if (MutationObserver) {\n        const obs = new MutationObserver(callback);\n\n        obs.observe(obj, {\n            childList: true,\n            subtree: true\n        });\n\n        return obs;\n    }\n\n    obj.addEventListener('DOMNodeInserted', callback, false);\n    obj.addEventListener('DOMNodeRemoved', callback, false);\n\n    return null;\n}\n\nexport default observeDOM;\n","import observeDOM from '../helpers/observe-dom';\n\n/**\n * Attaches the scroll event handler\n *\n * @return {void}\n */\nfunction attach() {\n    const container = this.options.container;\n\n    if (container instanceof HTMLElement) {\n        const style = window.getComputedStyle(container);\n\n        if (style.position === 'static') {\n            container.style.position = 'relative';\n        }\n    }\n\n    this._observer = observeDOM(document.querySelector('body'), () => {\n        Object.keys(this.trackedElements).forEach((element) => {\n            this.on('enter', element);\n            this.on('leave', element);\n        });\n    });\n\n    container.addEventListener('scroll', this._scroll, { passive: true });\n    window.addEventListener('resize', this._scroll, { passive: true });\n    this._scroll();\n    this.attached = true;\n}\n\nexport default attach;\n","/**\n * Checks an element's position in respect to the viewport\n * and determines wether it's inside the viewport.\n *\n * @param {node} element The DOM node you want to check\n * @return {boolean} A boolean value that indicates wether is on or off the viewport.\n */\nfunction inViewport(el, options = { tolerance: 0 }) {\n    if (!el) {\n        throw new Error('You should specify the element you want to test');\n    }\n\n    if (typeof el === 'string') {\n        el = document.querySelector(el);\n    }\n\n    const elRect = el.getBoundingClientRect();\n\n    return (\n        // Check bottom boundary\n        elRect.bottom - options.tolerance > 0 &&\n\n        // Check right boundary\n        elRect.right - options.tolerance > 0 &&\n\n        // Check left boundary\n        elRect.left + options.tolerance < (window.innerWidth ||\n        document.documentElement.clientWidth) &&\n\n        // Check top boundary\n        elRect.top + options.tolerance < (window.innerHeight ||\n        document.documentElement.clientHeight)\n    );\n}\n\nexport default inViewport;\n","/**\n * Checks an element's position in respect to a HTMLElement\n * and determines wether it's within its boundaries.\n *\n * @param {node} element The DOM node you want to check\n * @return {boolean} A boolean value that indicates wether is on or off the container.\n */\nfunction inContainer(el, options = { tolerance: 0, container: '' }) {\n    if (!el) {\n        throw new Error('You should specify the element you want to test');\n    }\n\n    if (typeof el === 'string') {\n        el = document.querySelector(el);\n    }\n    if (typeof options === 'string') {\n        options = {\n            tolerance: 0,\n            container: document.querySelector(options)\n        };\n    }\n    if (typeof options.container === 'string') {\n        options.container = document.querySelector(options.container);\n    }\n    if (options instanceof HTMLElement) {\n        options = {\n            tolerance: 0,\n            container: options\n        };\n    }\n    if (!options.container) {\n        throw new Error('You should specify a container element');\n    }\n\n    const containerRect = options.container.getBoundingClientRect();\n\n    return (\n        // // Check bottom boundary\n        (el.offsetTop + el.clientHeight) - options.tolerance >\n        options.container.scrollTop &&\n\n        // Check right boundary\n        (el.offsetLeft + el.clientWidth) - options.tolerance >\n        options.container.scrollLeft &&\n\n        // Check left boundary\n        el.offsetLeft + options.tolerance <\n        containerRect.width + options.container.scrollLeft &&\n\n        // // Check top boundary\n        el.offsetTop + options.tolerance <\n        containerRect.height + options.container.scrollTop\n    );\n}\n\nexport default inContainer;\n","import inViewport from './in-viewport';\nimport inContainer from './in-container';\n\n// TODO: Refactor this so it can be easily tested\n/* istanbul ignore next */\nfunction eventHandler(trackedElements = {}, options = { tolerance: 0 }) {\n    const selectors = Object.keys(trackedElements);\n    let testVisibility;\n\n    if (!selectors.length) return;\n\n    if (options.container === window) {\n        testVisibility = inViewport;\n    } else {\n        testVisibility = inContainer;\n    }\n\n    selectors.forEach((selector) => {\n        trackedElements[selector].nodes.forEach((item) => {\n            if (testVisibility(item.node, options)) {\n                item.wasVisible = item.isVisible;\n                item.isVisible = true;\n            } else {\n                item.wasVisible = item.isVisible;\n                item.isVisible = false;\n            }\n            if (item.isVisible === true && item.wasVisible === false) {\n                if (!trackedElements[selector].enter) return;\n\n                Object.keys(trackedElements[selector].enter).forEach((callback) => {\n                    if (typeof trackedElements[selector].enter[callback] === 'function') {\n                        trackedElements[selector].enter[callback](item.node, 'enter');\n                    }\n                });\n            }\n            if (item.isVisible === false && item.wasVisible === true) {\n                if (!trackedElements[selector].leave) return;\n\n                Object.keys(trackedElements[selector].leave).forEach((callback) => {\n                    if (typeof trackedElements[selector].leave[callback] === 'function') {\n                        trackedElements[selector].leave[callback](item.node, 'leave');\n                    }\n                });\n            }\n        });\n    });\n}\n\nexport default eventHandler;\n","import scrollHandler from '../helpers/scroll-handler';\n\n/**\n * Debounces the scroll event to avoid performance issues\n *\n * @return {void}\n */\nfunction debouncedScroll() {\n    let timeout;\n\n    if (this.options.debounce === false) {\n        return () => scrollHandler(this.trackedElements, this.options);\n    }\n\n    return () => {\n        clearTimeout(timeout);\n\n        timeout = setTimeout(() => {\n            scrollHandler(this.trackedElements, this.options);\n        }, this.options.debounce);\n    };\n}\n\nexport default debouncedScroll;\n","/**\n * Removes the scroll event handler\n *\n * @return {void}\n */\nfunction destroy() {\n    if (this._observer instanceof MutationObserver) {\n        this._observer.disconnect();\n    }\n\n    this.options.container.removeEventListener('scroll', this._scroll);\n    window.removeEventListener('resize', this._scroll);\n    this.attached = false;\n}\n\nexport default destroy;\n","/**\n * Stops tracking elements matching a CSS selector. If a selector has no\n * callbacks it gets removed.\n *\n * @param {string} event The event you want to stop tracking (enter or leave)\n * @param {string} selector The CSS selector you want to stop tracking\n * @return {void}\n */\nfunction off(event, selector, handler) {\n    const enterCallbacks = Object.keys(this.trackedElements[selector].enter || {});\n    const leaveCallbacks = Object.keys(this.trackedElements[selector].leave || {});\n\n    if ({}.hasOwnProperty.call(this.trackedElements, selector)) {\n        if (handler) {\n            if (this.trackedElements[selector][event]) {\n                const callbackName = (typeof handler === 'function') ? handler.name : handler;\n                delete this.trackedElements[selector][event][callbackName];\n            }\n        } else {\n            delete this.trackedElements[selector][event];\n        }\n    }\n\n    if (!enterCallbacks.length && !leaveCallbacks.length) {\n        delete this.trackedElements[selector];\n    }\n}\n\nexport default off;\n","/**\n * Starts tracking elements matching a CSS selector\n *\n * @param {string} event The event you want to track (enter or leave)\n * @param {string} selector The element you want to track\n * @param {function} callback The callback function to handle the event\n * @return {void}\n */\nfunction on(event, selector, callback) {\n    const allowed = ['enter', 'leave'];\n\n    if (!event) throw new Error('No event given. Choose either enter or leave');\n    if (!selector) throw new Error('No selector to track');\n    if (allowed.indexOf(event) < 0) throw new Error(`${event} event is not supported`);\n\n    if (!{}.hasOwnProperty.call(this.trackedElements, selector)) {\n        this.trackedElements[selector] = {};\n    }\n\n    this.trackedElements[selector].nodes = [];\n\n    for (let i = 0, elems = document.querySelectorAll(selector); i < elems.length; i++) {\n        const item = {\n            isVisible: false,\n            wasVisible: false,\n            node: elems[i]\n        };\n\n        this.trackedElements[selector].nodes.push(item);\n    }\n\n    if (typeof callback === 'function') {\n        if (!this.trackedElements[selector][event]) {\n            this.trackedElements[selector][event] = {};\n        }\n\n        this.trackedElements[selector][event][(callback.name || 'anonymous')] = callback;\n    }\n}\n\nexport default on;\n","// Methods\nimport attach from './methods/attach';\nimport debouncedScroll from './methods/debounced-scroll';\nimport destroy from './methods/destroy';\nimport off from './methods/off';\nimport on from './methods/on';\n\n// Helpers\nimport inViewport from './helpers/in-viewport';\n\n/**\n * Detects wether DOM nodes enter or leave the viewport\n *\n * @constructor\n * @param {object} options The configuration object\n */\nfunction OnScreen(options = { tolerance: 0, debounce: 100, container: window }) {\n    this.options = {};\n    this.trackedElements = {};\n\n    Object.defineProperties(this.options, {\n        container: {\n            configurable: false,\n            enumerable: false,\n            get() {\n                let container;\n\n                if (typeof options.container === 'string') {\n                    container = document.querySelector(options.container);\n                } else if (options.container instanceof HTMLElement) {\n                    container = options.container;\n                }\n\n                return container || window;\n            },\n            set(value) {\n                options.container = value;\n            }\n        },\n        debounce: {\n            get() {\n                if (options.debounce === false) {\n                    return false;\n                }\n\n                return parseInt(options.debounce, 10) || 100;\n            },\n            set(value) {\n                options.debounce = value;\n            }\n        },\n        tolerance: {\n            get() {\n                return parseInt(options.tolerance, 10) || 0;\n            },\n            set(value) {\n                options.tolerance = value;\n            }\n        }\n    });\n\n    Object.defineProperty(this, '_scroll', {\n        enumerable: false,\n        configurable: false,\n        writable: false,\n        value: this._debouncedScroll.call(this)\n    });\n\n    this.attach();\n}\n\nObject.defineProperties(OnScreen.prototype, {\n    _debouncedScroll: {\n        configurable: false,\n        writable: false,\n        enumerable: false,\n        value: debouncedScroll\n    },\n    attach: {\n        configurable: false,\n        writable: false,\n        enumerable: false,\n        value: attach\n    },\n    destroy: {\n        configurable: false,\n        writable: false,\n        enumerable: false,\n        value: destroy\n    },\n    off: {\n        configurable: false,\n        writable: false,\n        enumerable: false,\n        value: off\n    },\n    on: {\n        configurable: false,\n        writable: false,\n        enumerable: false,\n        value: on\n    }\n});\n\nOnScreen.check = inViewport;\n\nexport default OnScreen;\n"],"names":["observeDOM","obj","callback","MutationObserver","window","WebKitMutationObserver","obs","observe","childList","subtree","addEventListener","attach","container","options","HTMLElement","style","getComputedStyle","position","_observer","document","querySelector","Object","keys","trackedElements","forEach","element","on","_scroll","passive","attached","inViewport","el","tolerance","Error","elRect","getBoundingClientRect","bottom","right","left","innerWidth","documentElement","clientWidth","top","innerHeight","clientHeight","inContainer","containerRect","offsetTop","scrollTop","offsetLeft","scrollLeft","width","height","eventHandler","selectors","testVisibility","length","selector","nodes","item","node","wasVisible","isVisible","enter","leave","debouncedScroll","timeout","debounce","scrollHandler","clearTimeout","setTimeout","destroy","disconnect","removeEventListener","off","event","handler","enterCallbacks","leaveCallbacks","hasOwnProperty","call","callbackName","name","allowed","indexOf","i","elems","querySelectorAll","push","OnScreen","defineProperties","configurable","enumerable","get","set","value","parseInt","defineProperty","writable","_debouncedScroll","prototype","check"],"mappings":"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"}